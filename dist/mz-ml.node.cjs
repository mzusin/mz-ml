/* 
mzMl v1.0.0
A collection of TypeScript-based ML helpers.
https://github.com/mzusin/mz-ml
Copyright (c) 2023-present, Miriam Zusin          
*/
var c=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var d=Object.prototype.hasOwnProperty;var S=(i,s,t)=>s in i?c(i,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[s]=t;var z=(i,s)=>{for(var t in s)c(i,t,{get:s[t],enumerable:!0})},y=(i,s,t,e)=>{if(s&&typeof s=="object"||typeof s=="function")for(let h of w(s))!d.call(i,h)&&h!==t&&c(i,h,{get:()=>s[h],enumerable:!(e=m(s,h))||e.enumerable});return i};var j=i=>y(c({},"__esModule",{value:!0}),i);var r=(i,s,t)=>(S(i,typeof s!="symbol"?s+"":s,t),t);var v={};z(v,{LinearRegression:()=>o});module.exports=j(v);var o=class{constructor(s){r(this,"options");r(this,"weights");r(this,"bias");r(this,"features");r(this,"labels");r(this,"n");r(this,"batchSize");var t;this.options=s,this.features=[...this.options.features],this.labels=[...this.options.labels],this.n=this.features.length>0?this.features[0].length:0,this.weights=o.initZeroArray(this.n),this.weights.length=this.n,this.weights.fill(0),this.bias=0,this.batchSize=(t=this.options.batchSize)!=null?t:this.features.length}static initZeroArray(s){let t=[];return t.length=s,t.fill(0),t}shuffle(){let s=[];for(let t=0;t<this.n;t++)s.push(t);for(let t=this.features.length-1;t>0;t--){let e=Math.floor(Math.random()*(t+1));[s[t],s[e]]=[s[e],s[t]]}for(let t=this.features.length-1;t>0;t--)[this.features[t],this.features[s[t]]]=[this.features[s[t]],this.features[t]],[this.labels[t],this.labels[s[t]]]=[this.labels[s[t]],this.labels[t]]}gradientDescent(s,t){let e=o.initZeroArray(this.n),h=0;for(let n=0;n<s.length;n++){let b=s[n],f=t[n],p=this.predict(b),g=f-p;for(let u=0;u<this.n;u++)e[u]+=-2*b[u]*g;h+=-2*g}let a=[];for(let n=0;n<this.weights.length;n++){let f=this.weights[n]-this.options.learningRate/this.batchSize*e[n];a.push(f)}let l=this.bias-this.options.learningRate/this.batchSize*h;return[a,l]}train(){for(let s=0;s<this.options.epochs;s++){this.options.shuffle&&this.shuffle();for(let t=0;t<this.features.length;t+=this.batchSize){let e=this.features.slice(t,t+this.batchSize),h=this.labels.slice(t,t+this.batchSize),[a,l]=this.gradientDescent(e,h);typeof this.options.epochsCallback=="function"&&this.options.epochsCallback(s,this.options.epochs,a,l),this.weights=a,this.bias=l}}return[this.weights,this.bias]}predict(s){if(s.length!==this.weights.length)throw new Error("Number of features does not match the number of weights.");let t=this.bias;for(let e=0;e<s.length;e++)t+=s[e]*this.weights[e];return t}};0&&(module.exports={LinearRegression});
//# sourceMappingURL=mz-ml.node.cjs.map
