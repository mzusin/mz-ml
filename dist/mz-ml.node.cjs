/* 
mzMl v1.0.0
A collection of TypeScript-based ML helpers.
https://github.com/mzusin/mz-ml
Copyright (c) 2023-present, Miriam Zusin          
*/
var b=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var d=Object.prototype.hasOwnProperty;var S=(s,t,i)=>t in s?b(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i;var z=(s,t)=>{for(var i in t)b(s,i,{get:t[i],enumerable:!0})},y=(s,t,i,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of w(t))!d.call(s,n)&&n!==i&&b(s,n,{get:()=>t[n],enumerable:!(e=m(t,n))||e.enumerable});return s};var A=s=>y(b({},"__esModule",{value:!0}),s);var r=(s,t,i)=>(S(s,typeof t!="symbol"?t+"":t,i),i);var I={};z(I,{LinearRegression:()=>o});module.exports=A(I);var o=class{constructor(t){r(this,"options");r(this,"weights");r(this,"bias");r(this,"features");r(this,"labels");r(this,"n");r(this,"batchSize");var i;this.options=t,this.features=[...this.options.features],this.labels=[...this.options.labels],this.n=this.features.length,this.weights=o.initZeroArray(this.n),this.weights.length=this.n,this.weights.fill(0),this.bias=0,this.batchSize=(i=this.options.batchSize)!=null?i:this.n}static initZeroArray(t){let i=[];return i.length=t,i.fill(0),i}gradientDescent(t,i){let e=o.initZeroArray(this.n),n=0;for(let h=0;h<t.length;h++){let u=t[h],p=i[h],f=this.predict(u),g=p-f;for(let l=0;l<this.n;l++)e[l]+=-2*u[l]*g;n+=-2*g}let a=[];for(let h=0;h<this.weights.length;h++){let p=this.weights[h]-this.options.learningRate/this.batchSize*e[h];a.push(p)}let c=this.bias-this.options.learningRate/this.batchSize*n;return[a,c]}train(){for(let t=0;t<this.options.epochs;t++)for(let i=0;i<this.n;i+=this.batchSize){let e=this.features.slice(i,i+this.batchSize),n=this.labels.slice(i,i+this.batchSize),[a,c]=this.gradientDescent(e,n);typeof this.options.epochsCallback=="function"&&this.options.epochsCallback(t,this.options.epochs,a,c),this.weights=a,this.bias=c}return[this.weights,this.bias]}predict(t){if(t.length!==this.weights.length)throw new Error("Number of features does not match the number of weights.");let i=this.bias;for(let e=0;e<t.length;e++)i+=t[e]*this.weights[e];return i}};0&&(module.exports={LinearRegression});
//# sourceMappingURL=mz-ml.node.cjs.map
