/* 
mzMl v1.0.0
A collection of TypeScript-based ML helpers.
https://github.com/mzusin/mz-ml
Copyright (c) 2023-present, Miriam Zusin          
*/
var f=Object.defineProperty;var m=(h,i,t)=>i in h?f(h,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[i]=t;var n=(h,i,t)=>(m(h,typeof i!="symbol"?i+"":i,t),t);var o=class{constructor(i){n(this,"options");n(this,"weights");n(this,"bias");n(this,"features");n(this,"labels");n(this,"n");n(this,"batchSize");var t;this.options=i,this.features=[...this.options.features],this.labels=[...this.options.labels],this.n=this.features.length,this.weights=o.initZeroArray(this.n),this.weights.length=this.n,this.weights.fill(0),this.bias=0,this.batchSize=(t=this.options.batchSize)!=null?t:this.n}static initZeroArray(i){let t=[];return t.length=i,t.fill(0),t}gradientDescent(i,t){let s=o.initZeroArray(this.n),a=0;for(let e=0;e<i.length;e++){let b=i[e],u=t[e],g=this.predict(b),p=u-g;for(let l=0;l<this.n;l++)s[l]+=-2*b[l]*p;a+=-2*p}let r=[];for(let e=0;e<this.weights.length;e++){let u=this.weights[e]-this.options.learningRate/this.batchSize*s[e];r.push(u)}let c=this.bias-this.options.learningRate/this.batchSize*a;return[r,c]}train(){for(let i=0;i<this.options.epochs;i++)for(let t=0;t<this.n;t+=this.batchSize){let s=this.features.slice(t,t+this.batchSize),a=this.labels.slice(t,t+this.batchSize),[r,c]=this.gradientDescent(s,a);typeof this.options.epochsCallback=="function"&&this.options.epochsCallback(i,this.options.epochs,r,c),this.weights=r,this.bias=c}return[this.weights,this.bias]}predict(i){if(i.length!==this.weights.length)throw new Error("Number of features does not match the number of weights.");let t=this.bias;for(let s=0;s<i.length;s++)t+=i[s]*this.weights[s];return t}};export{o as LinearRegression};
//# sourceMappingURL=mz-ml.esm.js.map
