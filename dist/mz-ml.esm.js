/* 
mzMl v1.0.0
A collection of TypeScript-based ML helpers.
https://github.com/mzusin/mz-ml
Copyright (c) 2023-present, Miriam Zusin          
*/
var d=Object.defineProperty;var f=(e,t,s)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var a=(e,t,s)=>(f(e,typeof t!="symbol"?t+"":t,s),s);var u=class{constructor(t){a(this,"options");a(this,"m");a(this,"b");this.options=t,this.m=0,this.b=0}shuffle(){for(let t=this.options.points.length-1;t>0;t--){let s=Math.floor(Math.random()*(t+1));[this.options.points[t],this.options.points[s]]=[this.options.points[s],this.options.points[t]]}}gradientDescent(t,s){let i=0,n=0,o=this.options.points.length;for(let r=0;r<o;r++){let[p,b]=this.options.points[r],m=t*p+s,l=-2/o*(b-m);i+=p*l,n+=l}let h=t-this.options.learningRate*i,c=s-this.options.learningRate*n;return[h,c]}stochasticGradientDescent(t,s){let i=this.m*t+this.b,n=s-i,o=-2*t*n,h=-2*n,c=this.m-this.options.learningRate*o,r=this.b-this.options.learningRate*h;return[c,r]}train(){for(let t=0;t<this.options.epochs;t++)switch(this.options.optimization){case 1:{this.options.shuffle&&this.shuffle();for(let[s,i]of this.options.points){let[n,o]=this.stochasticGradientDescent(s,i);typeof this.options.epochsCallback=="function"&&this.options.epochsCallback(t,this.options.epochs,n,o),this.m=n,this.b=o}break}default:{let[s,i]=this.gradientDescent(this.m,this.b);this.options.epochsCallback&&typeof this.options.epochsCallback=="function"&&this.options.epochsCallback(t,this.options.epochs,s,i),this.m=s,this.b=i;break}}return[this.m,this.b]}predict(t){return this.m*t+this.b}};export{u as SimpleLinearRegression};
//# sourceMappingURL=mz-ml.esm.js.map
