/* 
mzMl v1.0.0
A collection of TypeScript-based ML helpers.
https://github.com/mzusin/mz-ml
Copyright (c) 2023-present, Miriam Zusin          
*/
var m=Object.defineProperty;var u=(r,t,i)=>t in r?m(r,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[t]=i;var c=(r,t,i)=>(u(r,typeof t!="symbol"?t+"":t,i),i);var b=class{constructor(t){c(this,"options");c(this,"m");c(this,"b");this.options=t,this.m=0,this.b=0}shuffle(){for(let t=this.options.points.length-1;t>0;t--){let i=Math.floor(Math.random()*(t+1));[this.options.points[t],this.options.points[i]]=[this.options.points[i],this.options.points[t]]}}gradientDescent(){let t=0,i=0,s=this.options.points.length;for(let o=0;o<s;o++){let[h,p]=this.options.points[o],l=this.m*h+this.b,a=-2/s*(p-l);t+=h*a,i+=a}let n=this.m-this.options.learningRate*t,e=this.b-this.options.learningRate*i;return[n,e]}miniBatchGradientDescent(t){let i=0,s=0,n=t.length;for(let[h,p]of t){let l=this.m*h+this.b,a=p-l;i+=-2*h*a,s+=-2*a}let e=this.m-this.options.learningRate/n*i,o=this.b-this.options.learningRate/n*s;return[e,o]}train(){var i;let t=this.options.optimization===2?(i=this.options.batchSize)!=null?i:this.options.points.length:1;for(let s=0;s<this.options.epochs;s++)if(this.options.shuffle&&this.shuffle(),this.options.optimization===1||this.options.optimization===2)for(let n=0;n<this.options.points.length;n+=t){let e=this.options.points.slice(n,n+t),[o,h]=this.miniBatchGradientDescent(e);typeof this.options.epochsCallback=="function"&&this.options.epochsCallback(s,this.options.epochs,o,h),this.m=o,this.b=h}else{let[n,e]=this.gradientDescent();this.options.epochsCallback&&typeof this.options.epochsCallback=="function"&&this.options.epochsCallback(s,this.options.epochs,n,e),this.m=n,this.b=e}return[this.m,this.b]}predict(t){return this.m*t+this.b}};export{b as LinearRegression};
//# sourceMappingURL=mz-ml.esm.js.map
