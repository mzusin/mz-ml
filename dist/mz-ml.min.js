/* 
mzMl v1.0.0
A collection of TypeScript-based ML helpers.
https://github.com/mzusin/mz-ml
Copyright (c) 2023-present, Miriam Zusin          
*/
(()=>{var g=Object.defineProperty;var m=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var u=(o,t,i)=>t in o?g(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i,M=(o,t)=>{for(var i in t||(t={}))B.call(t,i)&&u(o,i,t[i]);if(m)for(var i of m(t))k.call(t,i)&&u(o,i,t[i]);return o};var D=(o,t)=>{for(var i in t)g(o,i,{get:t[i],enumerable:!0})};var l=(o,t,i)=>(u(o,typeof t!="symbol"?t+"":t,i),i);var d={};D(d,{LinearRegression:()=>b});var b=class{constructor(t){l(this,"options");l(this,"m");l(this,"b");this.options=t,this.m=0,this.b=0}shuffle(){for(let t=this.options.points.length-1;t>0;t--){let i=Math.floor(Math.random()*(t+1));[this.options.points[t],this.options.points[i]]=[this.options.points[i],this.options.points[t]]}}gradientDescent(t,i){let n=0,s=0,e=this.options.points.length;for(let h=0;h<e;h++){let[c,p]=this.options.points[h],G=t*c+i,f=-2/e*(p-G);n+=c*f,s+=f}let r=t-this.options.learningRate*n,a=i-this.options.learningRate*s;return[r,a]}stochasticGradientDescent(t,i){let n=this.m*t+this.b,s=i-n,e=-2*t*s,r=-2*s,a=this.m-this.options.learningRate*e,h=this.b-this.options.learningRate*r;return[a,h]}miniBatchGradientDescent(t){let i=0,n=0,s=t.length;for(let[a,h]of t){let c=this.m*a+this.b,p=h-c;i+=-2*a*p,n+=-2*p}let e=this.m-this.options.learningRate/s*i,r=this.b-this.options.learningRate/s*n;return[e,r]}train(){var i;let t=(i=this.options.batchSize)!=null?i:this.options.points.length;for(let n=0;n<this.options.epochs;n++)switch(this.options.optimization){case 1:{this.options.shuffle&&this.shuffle();for(let[s,e]of this.options.points){let[r,a]=this.stochasticGradientDescent(s,e);typeof this.options.epochsCallback=="function"&&this.options.epochsCallback(n,this.options.epochs,r,a),this.m=r,this.b=a}break}case 2:{this.options.shuffle&&this.shuffle();for(let s=0;s<this.options.points.length;s+=t){let e=this.options.points.slice(s,s+t),[r,a]=this.miniBatchGradientDescent(e);typeof this.options.epochsCallback=="function"&&this.options.epochsCallback(n,this.options.epochs,r,a),this.m=r,this.b=a}break}default:{let[s,e]=this.gradientDescent(this.m,this.b);this.options.epochsCallback&&typeof this.options.epochsCallback=="function"&&this.options.epochsCallback(n,this.options.epochs,s,e),this.m=s,this.b=e;break}}return[this.m,this.b]}predict(t){return this.m*t+this.b}};var R=M({},d);window.mzMl=window.mzMl||R;})();
//# sourceMappingURL=mz-ml.min.js.map
