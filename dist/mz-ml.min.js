/* 
mzMl v1.0.0
A collection of TypeScript-based ML helpers.
https://github.com/mzusin/mz-ml
Copyright (c) 2023-present, Miriam Zusin          
*/
(()=>{var w=Object.defineProperty;var m=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var b=(i,e,t)=>e in i?w(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,d=(i,e)=>{for(var t in e||(e={}))S.call(e,t)&&b(i,t,e[t]);if(m)for(var t of m(e))M.call(e,t)&&b(i,t,e[t]);return i};var y=(i,e)=>{for(var t in e)w(i,t,{get:e[t],enumerable:!0})};var n=(i,e,t)=>(b(i,typeof e!="symbol"?e+"":e,t),t);var p={};y(p,{LinearRegression:()=>r});var r=class{constructor(e){n(this,"options");n(this,"weights");n(this,"bias");n(this,"features");n(this,"labels");n(this,"n");n(this,"batchSize");var t;this.options=e,this.features=[...this.options.features],this.labels=[...this.options.labels],this.n=this.features.length>0?this.features[0].length:0,this.weights=r.initZeroArray(this.n),this.weights.length=this.n,this.weights.fill(0),this.bias=0,this.batchSize=(t=this.options.batchSize)!=null?t:this.features.length}static initZeroArray(e){let t=[];return t.length=e,t.fill(0),t}shuffle(){let e=[];for(let t=0;t<this.n;t++)e.push(t);for(let t=this.features.length-1;t>0;t--){let s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}for(let t=this.features.length-1;t>0;t--)[this.features[t],this.features[e[t]]]=[this.features[e[t]],this.features[t]],[this.labels[t],this.labels[e[t]]]=[this.labels[e[t]],this.labels[t]]}gradientDescent(e,t){let s=r.initZeroArray(this.n),a=0;for(let h=0;h<e.length;h++){let u=e[h],f=t[h],z=this.predict(u),g=f-z;for(let c=0;c<this.n;c++)s[c]+=-2*u[c]*g;a+=-2*g}let o=[];for(let h=0;h<this.weights.length;h++){let f=this.weights[h]-this.options.learningRate/this.batchSize*s[h];o.push(f)}let l=this.bias-this.options.learningRate/this.batchSize*a;return[o,l]}train(){for(let e=0;e<this.options.epochs;e++){this.options.shuffle&&this.shuffle();for(let t=0;t<this.features.length;t+=this.batchSize){let s=this.features.slice(t,t+this.batchSize),a=this.labels.slice(t,t+this.batchSize),[o,l]=this.gradientDescent(s,a);typeof this.options.epochsCallback=="function"&&this.options.epochsCallback(e,this.options.epochs,o,l),this.weights=o,this.bias=l}}return[this.weights,this.bias]}predict(e){if(e.length!==this.weights.length)throw new Error("Number of features does not match the number of weights.");let t=this.bias;for(let s=0;s<e.length;s++)t+=e[s]*this.weights[s];return t}};var j=d({},p);window.mzMl=window.mzMl||j;})();
//# sourceMappingURL=mz-ml.min.js.map
