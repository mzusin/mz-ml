/* 
mzMl v1.0.0
A collection of TypeScript-based ML helpers.
https://github.com/mzusin/mz-ml
Copyright (c) 2023-present, Miriam Zusin          
*/
(()=>{var w=Object.defineProperty;var f=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable;var u=(e,i,t)=>i in e?w(e,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[i]=t,d=(e,i)=>{for(var t in i||(i={}))S.call(i,t)&&u(e,t,i[t]);if(f)for(var t of f(i))y.call(i,t)&&u(e,t,i[t]);return e};var M=(e,i)=>{for(var t in i)w(e,t,{get:i[t],enumerable:!0})};var h=(e,i,t)=>(u(e,typeof i!="symbol"?i+"":i,t),t);var g={};M(g,{LinearRegression:()=>r});var r=class{constructor(i){h(this,"options");h(this,"weights");h(this,"bias");h(this,"features");h(this,"labels");h(this,"n");h(this,"batchSize");var t;this.options=i,this.features=[...this.options.features],this.labels=[...this.options.labels],this.n=this.features.length,this.weights=r.initZeroArray(this.n),this.weights.length=this.n,this.weights.fill(0),this.bias=0,this.batchSize=(t=this.options.batchSize)!=null?t:this.n}static initZeroArray(i){let t=[];return t.length=i,t.fill(0),t}gradientDescent(i,t){let s=r.initZeroArray(this.n),a=0;for(let n=0;n<i.length;n++){let b=i[n],p=t[n],z=this.predict(b),m=p-z;for(let c=0;c<this.n;c++)s[c]+=-2*b[c]*m;a+=-2*m}let o=[];for(let n=0;n<this.weights.length;n++){let p=this.weights[n]-this.options.learningRate/this.batchSize*s[n];o.push(p)}let l=this.bias-this.options.learningRate/this.batchSize*a;return[o,l]}train(){for(let i=0;i<this.options.epochs;i++)for(let t=0;t<this.n;t+=this.batchSize){let s=this.features.slice(t,t+this.batchSize),a=this.labels.slice(t,t+this.batchSize),[o,l]=this.gradientDescent(s,a);typeof this.options.epochsCallback=="function"&&this.options.epochsCallback(i,this.options.epochs,o,l),this.weights=o,this.bias=l}return[this.weights,this.bias]}predict(i){if(i.length!==this.weights.length)throw new Error("Number of features does not match the number of weights.");let t=this.bias;for(let s=0;s<i.length;s++)t+=i[s]*this.weights[s];return t}};var A=d({},g);window.mzMl=window.mzMl||A;})();
//# sourceMappingURL=mz-ml.min.js.map
